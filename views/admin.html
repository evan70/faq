<p>
	<a href="/faq/add">{"Add question"}</a>
	{% if User::require_acl ('settings') %}
	&nbsp;|&nbsp;
	<a href="/faq/settings">{"Settings"}</a>
	{% end %}
</p>

<p>
<table width="100%">
	<tr>
		<th width="34%">{" Question "}</th>
		<th width="12%">{" Category "}</th>
		<th width="38%">{" Answer "}</th>
		<th width="8%">&nbsp;</th>
	</tr>
	<tbody class="sortable" data-category="{{ loop_value->category_id }}">
{% foreach items %}
	<tr id="{{ loop_value->id }}">
		<td class="handle">{{ loop_value->question }}</td>
		<td class="handle">{{ loop_value->category|faq\Category::filter_name }}</td>
		<td class="handle" title="{{ loop_value->answer|strip_tags }}">{{ loop_value->answer|strip_tags|trim|substr (%s, 0, 77) }}...</td>
		<td class="handle">
			<a	href="/faq/edit?id={{ loop_value->id }}">{"Edit"}</a> |
			<a	href="/faq/delete?id={{ loop_value->id }}"
				onclick="return confirm ('{"Are you sure you want to delete this question?"}')">{"Delete"}</a>
		</td>
	</tr>
{% end %}
	</tbody>
</table>
</p>

<script>
$(function () {
	$('.sortable').sortable ({
		handle: '.handle',
		update: function () {
			var data = {
				list: $(this).sortable ('toArray'),
				category: $(this).data ('category')
			};

			$.ajax ({
				url: '/faq/sort',
				type: 'post',
				data: data,
				success: function () {
					$.add_notification ('Sorting order updated.');
				},
				error: function () {
					$.add_notification ('Failed to save the new sorting order.');
				}
			});
		}
	});
});
</script>

<style>
.handle:hover {
	cursor: move;
}
</style>